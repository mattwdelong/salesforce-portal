function ajax(a,b){return new Ember.RSVP.Promise(function(c,d){b=b||{},b.url=a,Ember.$.ajax(b).done(function(a){console.log(a),"Success"==a.response?c(a):d(new Error(a.message))}).fail(function(b,c,e){d(new Error("AJAX: `"+a+"` failed with status: ["+c+"] "+e))})})}App=Ember.Application.create({LOG_TRANSITIONS:!0}),App.Router.map(function(){this.resource("index",{path:"/"}),this.resource("people",{path:"/people"}),this.resource("person",{path:"/person/:Id"})}),App.PeopleController=Ember.ArrayController.extend({actions:{findPeople:function(){var a={name:this.get("find_name")},b=this;App.Person.find(a).then(function(a){var c=a.results;b.get("content").setObjects(c.records)}).catch(function(a){b.set("error",a.message)})},clearFind:function(){this.set("find_name",null),this.transitionToRoute("index")}}}),App.PersonController=Ember.ObjectController.extend({actions:{toggleTeam:function(a){var b=[],c=this;App.Person.updateTeam(this.get("model").Id,a.team_id).then(function(d){a.in_team=d.team.in_team,a.access_manage=d.team.access_manage,a.access_contact=d.team.access_contact,c.get("model").team_serving.forEach(function(c){b.push(c.team_id==a.team_id?a:c)}),c.get("model").team_serving.setObjects(b)}).catch(function(a){c.set("error",a.message)})}.observes("team_serving")}}),App.Person=Ember.Object.extend({}),App.Person.reopenClass({url:"/api/people",getAll:function(a){var b=this.url;return a&&(b=this.url+"/page/"+a),ajax(b,{type:"GET",contentType:"application/json; charset=utf-8"})},find:function(a){return ajax(this.url+"/find",{type:"POST",data:JSON.stringify(a),contentType:"application/json; charset=utf-8",dataType:"json"})},findById:function(a){return a&&"undefined"!==a||(a="me"),ajax(this.url+"/"+a,{type:"GET",contentType:"application/json; charset=utf-8",dataType:"json"})},updateTeam:function(a,b){return ajax(this.url+"/"+a+"/team/"+b,{type:"POST",data:JSON.stringify({}),contentType:"application/json; charset=utf-8",dataType:"json"})}}),App.IndexRoute=Ember.Route.extend({beforeModel:function(){this.transitionTo("people")}}),App.PeopleRoute=Ember.Route.extend({model:function(){return[]}}),App.PersonRoute=Ember.Route.extend({model:function(a){return"undefined"===a.id&&this.transitionTo("person","me"),App.Person.findById(a.Id).then(function(a){return console.log(a.person.small_groups.records),a.person})}});